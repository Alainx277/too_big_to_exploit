-- migrate:up
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR NOT NULL,
    password VARCHAR NOT NULL
);

CREATE TABLE accounts (
    id SERIAL PRIMARY KEY,
    name VARCHAR NOT NULL,
    balance NUMERIC(18, 2) NOT NULL
);

CREATE TABLE account_owners (
    id SERIAL PRIMARY KEY,
    user_id SERIAL REFERENCES users(id) NOT NULL,
    account_id SERIAL REFERENCES accounts(id) NOT NULL
);

CREATE TABLE transactions (
    id SERIAL PRIMARY KEY,
    from_account_id SERIAL REFERENCES accounts(id) NOT NULL,
    to_account_id SERIAL REFERENCES accounts(id) NOT NULL,
    amount NUMERIC(18, 2) NOT NULL
);

-- Test data

INSERT INTO users(id, username, password)
VALUES (1, 'johndoe', 'ISpendAllMyMoney$$OnHats'),
       (2, 'janedoe', 'HowDoIInvestInCrypto???'),
       (3, 'evildude', 'AllYourMoneyBelongsToMe:)');

INSERT INTO accounts(id, name, balance)
VALUES (1, 'John Doe Private Account', 2500),
       (2, 'Jane Doe Private Account', 2500),
       (3, 'Doe Joint Account', 35000),
       (4, 'Evil Account', 50);

INSERT INTO account_owners(id, user_id, account_id)
VALUES (1, 1, 1),
       (2, 2, 2),
       (3, 1, 3),
       (4, 2, 3),
       (5, 3, 4);

-- migrate:down

